# Depends:
#  meson, ninja, glib
# Optional depends:
#  libpng, libtiff, libjpeg (libjpeg-turbo), libjasper, libX11, gobject-introspection

# FIXME: jpeg loader not working (missing dependency?)
# FIXME: linking to libintl (required?)

DEPENDS=(glib libpng)

VER="2.38.1"
DNAME="${NAME}-${VER}"
FNAME="${DNAME}.tar.xz"
SOURCE="https://ftp.acc.umu.se/pub/GNOME/sources/gdk-pixbuf/${VER%.*}/${FNAME}"
EXCLUDE_EXTRACT="tests/test-images/reftests/tga"
CMD_CONFIG=(meson)
CMD_BUILD=(ninja)
CMD_INSTALL=(ninja install)

CONFIG_OPTS=(
	-Dgir=false
	-Dman=false
	-Dinstalled_tests=false
	-Dtiff=false
	-Djpeg=false
)

LIBS="`pkg-config glib-2.0 --libs --static` `pkg-config libtiff-4 --libs --static` -liconv"
if ${OS_WIN}; then
	CONFIG_OPTS+=(-Dx11=false)
	LIBS+=" -lws2_32"
fi
LDFLAGS="${LIBS}"
